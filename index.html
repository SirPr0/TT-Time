<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TT Clock</title>
<link rel="icon" type="image/x-icon" href="https://cdn.sirpro.cc/s/QbZlfI.ico">
<style>
    html, body {
        margin: 0;
        width: 100%;
        height: 100%;
        background: transparent;
        overflow: hidden;
        font-family: "Segoe UI", Tahoma, sans-serif;
        color: white;
        user-select: none;
    }

    .item {
        position: absolute;
        cursor: grab;
    }

    .item:active {
        cursor: grabbing;
    }

    #time {
        font-size: 1.00464vw;
        font-weight: 869;
    }

    #date {
        font-size: 1.00464vw;
        font-weight: 869;
        text-align: center;
        line-height: 1.1;
        text-transform: uppercase;
    }

    @media (max-width: 768px) {
        #time {
            font-size: 2.5116vw;
        }
        #date {
            font-size: 2.5116vw;
        }
    }
</style>
</head>

<body>

<div class="item" id="time">--:--</div>

<div class="item" id="date">----</div>

<script>
function updateClock() {
    const now = new Date();

    document.getElementById("time").textContent =
        now.toLocaleTimeString(undefined, {
            hour: "2-digit",
            minute: "2-digit",
            hour12: true
        });

    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const year = now.getFullYear();
    const weekday = now.toLocaleDateString(undefined, { weekday: "short" });
    document.getElementById("date").textContent = `${month}/${day}/${year} | ${weekday}`;
}

updateClock();
setInterval(updateClock, 1000);

function makeDraggable(el, key) {
    let offsetX = 0, offsetY = 0, dragging = false;

    // load saved position
    const saved = JSON.parse(localStorage.getItem(key));
    if (saved) {
        el.style.left = saved.x + "px";
        el.style.top = saved.y + "px";
    } else {
        const centerX = window.innerWidth / 2 - el.offsetWidth / 2;
        const centerY = window.innerHeight / 2 - el.offsetHeight / 2;
        if (key === "clock_date_pos") {
            const timeEl = document.getElementById("time");
            el.style.left = centerX + "px";
            el.style.top = (centerY + timeEl.offsetHeight + 10) + "px";
        } else {
            el.style.left = centerX + "px";
            el.style.top = centerY + "px";
        }
    }

    el.addEventListener("mousedown", (e) => {
        dragging = true;
        offsetX = e.clientX - el.offsetLeft;
        offsetY = e.clientY - el.offsetTop;
    });

    document.addEventListener("mousemove", (e) => {
        if (!dragging) return;
        el.style.left = (e.clientX - offsetX) + "px";
        el.style.top = (e.clientY - offsetY) + "px";
    });

    document.addEventListener("mouseup", () => {
        if (!dragging) return;
        dragging = false;

        localStorage.setItem(key, JSON.stringify({
            x: el.offsetLeft,
            y: el.offsetTop
        }));
    });

    // right-click to reset to center
    el.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        const timeEl = document.getElementById("time");
        const dateEl = document.getElementById("date");
        const centerX = window.innerWidth / 2 - timeEl.offsetWidth / 2;
        const centerY = window.innerHeight / 2 - timeEl.offsetHeight / 2;
        const dateCenterY = centerY + timeEl.offsetHeight + 10; // offset date below time
        timeEl.style.left = centerX + "px";
        timeEl.style.top = centerY + "px";
        dateEl.style.left = centerX + "px";
        dateEl.style.top = dateCenterY + "px";
        localStorage.setItem("clock_time_pos", JSON.stringify({
            x: centerX,
            y: centerY
        }));
        localStorage.setItem("clock_date_pos", JSON.stringify({
            x: centerX,
            y: dateCenterY
        }));
    });
}

makeDraggable(document.getElementById("time"), "clock_time_pos");
makeDraggable(document.getElementById("date"), "clock_date_pos");

function toggleColor(el, key) {
    el.addEventListener('dblclick', () => {
        const currentColor = el.style.color || 'white';
        const newColor = currentColor === 'white' ? 'black' : 'white';
        el.style.color = newColor;
        localStorage.setItem(key, newColor);
    });

    const savedColor = localStorage.getItem(key);
    if (savedColor) {
        el.style.color = savedColor;
    }
}

toggleColor(document.getElementById("time"), "clock_time_color");
toggleColor(document.getElementById("date"), "clock_date_color");

// keyboard shortcut to reset positions
document.addEventListener('keydown', (e) => {
    if (e.key === 'r' || e.key === 'R') {
        const timeEl = document.getElementById("time");
        const dateEl = document.getElementById("date");
        const centerX = window.innerWidth / 2 - timeEl.offsetWidth / 2;
        const centerY = window.innerHeight / 2 - timeEl.offsetHeight / 2;
        const dateCenterY = centerY + timeEl.offsetHeight + 10;
        timeEl.style.left = centerX + "px";
        timeEl.style.top = centerY + "px";
        dateEl.style.left = centerX + "px";
        dateEl.style.top = dateCenterY + "px";
        localStorage.setItem("clock_time_pos", JSON.stringify({x: centerX, y: centerY}));
        localStorage.setItem("clock_date_pos", JSON.stringify({x: centerX, y: dateCenterY}));
    }
});
</script>

</body>
</html>
